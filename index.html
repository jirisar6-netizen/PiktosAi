<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PiktosAI - Komunika캜n칤 Asistent</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body { background: #eef2f5; font-family: sans-serif; margin: 0; padding: 10px; overflow-x: hidden; }
        
        /* Horn칤 li코ta - v캩ta */
        #sentence-builder {
            background: white;
            border: 4px solid #4a90e2;
            border-radius: 20px;
            min-height: 110px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            padding: 10px;
            gap: 10px;
            overflow-x: auto;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        /* Ak캜n칤 tla캜칤tka */
        .actions { display: flex; gap: 15px; margin-bottom: 20px; justify-content: center; }
        .btn-main { 
            padding: 20px 40px; border-radius: 50px; border: none; 
            font-size: 1.5rem; font-weight: bold; cursor: pointer; color: white;
            box-shadow: 0 5px 0 #27ae60; background: #2ecc71;
        }
        .btn-main:active { transform: translateY(3px); box-shadow: none; }
        .btn-clear { background: #e74c3c; box-shadow: 0 5px 0 #c0392b; }

        /* Vyhled치v치n칤 a kategorie */
        .search-area { margin-bottom: 20px; text-align: center; }
        #query { padding: 15px; width: 60%; border-radius: 30px; border: 2px solid #ddd; font-size: 1.1rem; }

        /* M콏칤쬶a karti캜ek */
        #grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); 
            gap: 15px; 
            max-width: 1000px; 
            margin: 0 auto;
        }
        
        .card {
            background: white; border-radius: 15px; padding: 10px;
            text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            cursor: pointer; transition: transform 0.1s;
            border-bottom: 4px solid #ddd;
        }
        .card:active { transform: scale(0.95); }
        .card img { width: 100%; height: auto; border-radius: 10px; }
        .card p { margin: 8px 0 0; font-weight: bold; text-transform: uppercase; font-size: 0.9rem; }
    </style>
</head>
<body>

    <div id="sentence-builder">
        <p id="hint" style="color: #aaa;">Klikni na kartu a za캜ni mluvit...</p>
    </div>

    <div class="actions">
        <button class="btn-main" onclick="speakSentence()">游댉 MLUVIT</button>
        <button class="btn-main btn-clear" onclick="resetAll()">SMAZAT</button>
    </div>

    <div class="search-area">
        <input type="text" id="query" placeholder="Hledej obr치zek..." oninput="handleInputSearch()">
    </div>

    <main id="grid">
        </main>

    <script type="module">
        import { searchPictos, getPictoUrl } from './api.js';
        import { voiceEngine } from './voice.js';

        let activeSentence = [];

        // Funkce pro vyhled치v치n칤 (spust칤 se p콏i psan칤)
        window.handleInputSearch = async () => {
            const val = document.getElementById('query').value;
            if (val.length < 2) return;

            const results = await searchPictos(val);
            const grid = document.getElementById('grid');
            grid.innerHTML = '';

            results.slice(0, 12).forEach(item => {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `<img src="${getPictoUrl(item._id)}"><p>${val}</p>`;
                card.onclick = () => addCardToSentence(item._id, val);
                grid.appendChild(card);
            });
        };

        // P콏id치n칤 karti캜ky do v캩ty
        window.addCardToSentence = (id, text) => {
            const builder = document.getElementById('sentence-builder');
            const hint = document.getElementById('hint');
            if (hint) hint.remove();

            const img = document.createElement('img');
            img.src = getPictoUrl(id);
            img.style.height = "80px";
            img.style.animation = "pop 0.3s ease-out";
            builder.appendChild(img);

            activeSentence.push(text);
            voiceEngine.speak(text); // P콏e캜te hned jednotliv칠 slovo
        };

        // AI Asistent p콏e캜te celou slo쬰nou v캩tu
        window.speakSentence = () => {
            if (activeSentence.length > 0) {
                voiceEngine.speak(activeSentence.join(" "));
            }
        };

        // Kompletn칤 smaz치n칤
        window.resetAll = () => {
            activeSentence = [];
            document.getElementById('sentence-builder').innerHTML = '<p id="hint" style="color: #aaa;">Klikni na kartu a za캜ni mluvit...</p>';
            document.getElementById('grid').innerHTML = '';
            document.getElementById('query').value = '';
        };

        // Z치kladn칤 sada pro za캜치tek
        window.onload = async () => {
            // Tady by mohl AI asistent nab칤dnout "캜ast칠 karty" (chci, j칤st, p칤t, Ji콏칤k)
        };
        import { loadStartCards } from './app.js';

// ... (p콏edchoz칤 k칩d)

window.onload = () => {
    loadStartCards();
};
        
    </script>
</body>
</html>
